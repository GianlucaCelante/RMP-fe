{"openapi":"3.1.0","info":{"title":"RMP Tenancy API","description":"API per la gestione multi-tenant della piattaforma RMP (Restaurant Management Platform)","contact":{"name":"RMP Team","email":"support@rmp.local"},"license":{"name":"Proprietary","url":"https://rmp.local/license"},"version":"v1"},"servers":[{"url":"http://localhost:8081/tenancy","description":"Development Server"},{"url":"https://api.rmp.local/tenancy","description":"Production Server"}],"security":[{"bearerAuth":[]}],"tags":[{"name":"Authentication","description":"Authentication and authorization APIs"},{"name":"Tenants","description":"Tenant management APIs - Platform Administrator only"},{"name":"Subscription Plans","description":"Subscription plan management APIs - Platform Administrator only"},{"name":"Billing Invoices","description":"Billing invoice management APIs - Platform Administrator only"},{"name":"Subscriptions","description":"Subscription management APIs - Platform Administrator only"},{"name":"Actuator","description":"Monitor and interact","externalDocs":{"description":"Spring Boot Actuator Web API Documentation","url":"https://docs.spring.io/spring-boot/docs/current/actuator-api/html/"}}],"paths":{"/api/v1/tenants/{id}":{"get":{"tags":["Tenants"],"summary":"Get tenant by ID","description":"Retrieve detailed information about a specific tenant by its unique identifier. Requires SUPER_ADMIN or ADMIN role.","operationId":"getTenantById","parameters":[{"name":"id","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Successfully retrieved tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid UUID format","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Tenant not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"tags":["Tenants"],"summary":"Update tenant information","description":"Update editable information of an existing tenant. Note: Code, schema name, and status cannot be updated through this endpoint. Requires SUPER_ADMIN or ADMIN role.","operationId":"updateTenant","parameters":[{"name":"id","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Tenant update request with fields to be updated (only provided fields will be updated)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTenantRequest"}}},"required":true},"responses":{"200":{"description":"Tenant updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Tenant not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"Conflict - Email, VAT number, or fiscal code already exists for another tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to update tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"tags":["Tenants"],"summary":"Cancel tenant","description":"Permanently cancel a tenant subscription. This is irreversible. Requires SUPER_ADMIN role.","operationId":"cancelTenant","parameters":[{"name":"id","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"},{"name":"reason","in":"query","description":"Reason for cancellation","required":true,"schema":{"type":"string"},"example":"Customer request"}],"responses":{"200":{"description":"Tenant cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid request - Tenant cannot be cancelled","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Tenant not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to cancel tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscription-plans/{id}":{"get":{"tags":["Subscription Plans"],"summary":"Get subscription plan by ID","description":"Retrieve detailed information about a specific subscription plan by its unique identifier. Requires SUPER_ADMIN or ADMIN role.","operationId":"getPlanById","parameters":[{"name":"id","in":"path","description":"Subscription plan unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Successfully retrieved subscription plan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription plan not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"tags":["Subscription Plans"],"summary":"Update subscription plan information","description":"Update editable information of an existing subscription plan. Note: Code cannot be updated through this endpoint. Requires SUPER_ADMIN or ADMIN role.","operationId":"updatePlan","parameters":[{"name":"id","in":"path","description":"Subscription plan unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Subscription plan update request with fields to be updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateSubscriptionPlanRequest"}}},"required":true},"responses":{"200":{"description":"Subscription plan updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription plan not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to update subscription plan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"tags":["Subscription Plans"],"summary":"Delete subscription plan","description":"Permanently delete a subscription plan. This operation is irreversible. Requires SUPER_ADMIN role.","operationId":"deletePlan","parameters":[{"name":"id","in":"path","description":"Subscription plan unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"204":{"description":"Subscription plan deleted successfully"},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription plan not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to delete subscription plan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/tenants":{"get":{"tags":["Tenants"],"summary":"Get all tenants","description":"Retrieve a paginated list of all tenants in the platform. Requires SUPER_ADMIN or ADMIN role.","operationId":"getAllTenants","parameters":[{"name":"page","in":"query","description":"Page number (0-based)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Page size (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20},{"name":"sort","in":"query","description":"Sort field","required":false,"schema":{"type":"string","default":"createdAt"},"example":"createdAt"},{"name":"direction","in":"query","description":"Sort direction (ASC or DESC)","required":false,"schema":{"type":"string","default":"DESC","enum":["ASC","DESC"]},"example":"DESC"}],"responses":{"200":{"description":"Successfully retrieved tenant list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantListResponse"}}}},"400":{"description":"Invalid pagination parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"tags":["Tenants"],"summary":"Create new tenant","description":"Create a new tenant with initial subscription and database schema. This operation will: (1) Create tenant record, (2) Create subscription, (3) Create dedicated database schema, (4) Initialize schema with tables. Requires SUPER_ADMIN role.","operationId":"createTenant","requestBody":{"description":"Tenant creation request with all required information","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTenantRequest"}}},"required":true},"responses":{"201":{"description":"Tenant created successfully with subscription and schema","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"Conflict - Tenant with the same code, email, VAT number, or fiscal code already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to create tenant, subscription, or database schema","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscription-plans":{"get":{"tags":["Subscription Plans"],"summary":"Get all subscription plans","description":"Retrieve a paginated list of all subscription plans in the platform. Requires SUPER_ADMIN or ADMIN role.","operationId":"getAllPlans","parameters":[{"name":"page","in":"query","description":"Page number (0-based)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Page size (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20},{"name":"sort","in":"query","description":"Sort field","required":false,"schema":{"type":"string","default":"sortOrder"},"example":"sortOrder"},{"name":"direction","in":"query","description":"Sort direction (ASC or DESC)","required":false,"schema":{"type":"string","default":"ASC","enum":["ASC","DESC"]},"example":"ASC"}],"responses":{"200":{"description":"Successfully retrieved subscription plan list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanListResponse"}}}},"400":{"description":"Invalid pagination parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"tags":["Subscription Plans"],"summary":"Create new subscription plan","description":"Create a new subscription plan with all details. This operation requires SUPER_ADMIN role.","operationId":"createPlan","requestBody":{"description":"Subscription plan creation request with all required information","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSubscriptionPlanRequest"}}},"required":true},"responses":{"201":{"description":"Subscription plan created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"Conflict - Plan with the same code already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to create subscription plan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/auth/refresh":{"post":{"tags":["Authentication"],"summary":"Refresh access token","description":"Get new access token using refresh token. Implements token rotation - returns both new access and refresh tokens.","operationId":"refreshToken","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Token refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenResponse"}}}},"401":{"description":"Invalid or expired refresh token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/auth/logout":{"post":{"tags":["Authentication"],"summary":"User logout","description":"Logout current user and revoke refresh token. Requires valid access token.","operationId":"logout","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}},"required":true},"responses":{"204":{"description":"Logout successful"},"401":{"description":"Unauthorized - Invalid or expired token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"Bearer Authentication":[]}]}},"/api/v1/auth/login":{"post":{"tags":["Authentication"],"summary":"User login","description":"Authenticate user with username and password. Returns access token and refresh token.","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"Invalid credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"423":{"description":"Account locked","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/tenants/{id}/suspend":{"patch":{"tags":["Tenants"],"summary":"Suspend tenant","description":"Change tenant status from ACTIVE to SUSPENDED. This temporarily disables tenant access. Requires SUPER_ADMIN or ADMIN role.","operationId":"suspendTenant","parameters":[{"name":"id","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"content":{"application/json":{"schema":{"type":"string","description":"Reason for suspension"}}},"required":true},"responses":{"200":{"description":"Tenant suspended successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid request - Tenant cannot be suspended (e.g., not active)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Tenant not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to suspend tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/tenants/{id}/activate":{"patch":{"tags":["Tenants"],"summary":"Activate tenant","description":"Change tenant status from PENDING to ACTIVE. This makes the tenant operational. Requires SUPER_ADMIN role.","operationId":"activateTenant","parameters":[{"name":"id","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Tenant activated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"400":{"description":"Invalid request - Tenant cannot be activated (e.g., already active or cancelled)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Tenant not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to activate tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/{id}/upgrade":{"patch":{"tags":["Subscriptions"],"summary":"Upgrade subscription plan","description":"Upgrade a subscription to a higher-tier plan. The change takes effect immediately and recalculates next payment amount. Requires SUPER_ADMIN role.","operationId":"upgradeSubscription","parameters":[{"name":"id","in":"path","description":"Subscription unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Upgrade subscription request with new plan code","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpgradeSubscriptionRequest"}}},"required":true},"responses":{"200":{"description":"Subscription upgraded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"400":{"description":"Invalid request data - Plan not found or not available","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to upgrade subscription","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/{id}/reactivate":{"patch":{"tags":["Subscriptions"],"summary":"Reactivate subscription","description":"Reactivate a cancelled subscription. Only works for subscriptions that are cancelled or scheduled for cancellation. Requires SUPER_ADMIN role.","operationId":"reactivateSubscription","parameters":[{"name":"id","in":"path","description":"Subscription unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Subscription reactivated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"400":{"description":"Invalid operation - Subscription is not cancelled","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to reactivate subscription","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/{id}/change-billing-cycle":{"patch":{"tags":["Subscriptions"],"summary":"Change billing cycle","description":"Change the billing cycle of a subscription between MONTHLY and YEARLY. The change takes effect on the next billing period. Requires SUPER_ADMIN role.","operationId":"changeBillingCycle","parameters":[{"name":"id","in":"path","description":"Subscription unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Change billing cycle request with new cycle","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangeBillingCycleRequest"}}},"required":true},"responses":{"200":{"description":"Billing cycle changed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"400":{"description":"Invalid request data - Same billing cycle or validation errors","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to change billing cycle","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/{id}/cancel":{"patch":{"tags":["Subscriptions"],"summary":"Cancel subscription","description":"Cancel a subscription either immediately or at the end of the current billing period. Requires SUPER_ADMIN role.","operationId":"cancelSubscription","parameters":[{"name":"id","in":"path","description":"Subscription unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Cancellation request with reason and immediate flag","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelSubscriptionRequest"}}},"required":true},"responses":{"200":{"description":"Subscription cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to cancel subscription","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscription-plans/{id}/deactivate":{"patch":{"tags":["Subscription Plans"],"summary":"Deactivate subscription plan","description":"Make a subscription plan inactive and unavailable for selection. Requires SUPER_ADMIN role.","operationId":"deactivatePlan","parameters":[{"name":"id","in":"path","description":"Subscription plan unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Subscription plan deactivated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription plan not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscription-plans/{id}/activate":{"patch":{"tags":["Subscription Plans"],"summary":"Activate subscription plan","description":"Make a subscription plan active and available for selection. Requires SUPER_ADMIN role.","operationId":"activatePlan","parameters":[{"name":"id","in":"path","description":"Subscription plan unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Subscription plan activated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription plan not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/{id}/send":{"patch":{"tags":["Billing Invoices"],"summary":"Mark invoice as sent","description":"Mark a draft invoice as sent to the customer. Only draft invoices can be marked as sent. Requires SUPER_ADMIN role.","operationId":"markInvoiceAsSent","parameters":[{"name":"id","in":"path","description":"Invoice unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Invoice marked as sent successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponse"}}}},"400":{"description":"Invalid operation - Invoice is not in draft status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Invoice not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to mark invoice as sent","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/{id}/pay":{"patch":{"tags":["Billing Invoices"],"summary":"Mark invoice as paid","description":"Mark an invoice as paid with payment details. Requires SUPER_ADMIN role.","operationId":"markInvoiceAsPaid","parameters":[{"name":"id","in":"path","description":"Invoice unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Payment details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MarkInvoiceAsPaidRequest"}}},"required":true},"responses":{"200":{"description":"Invoice marked as paid successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Invoice not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to mark invoice as paid","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/{id}/cancel":{"patch":{"tags":["Billing Invoices"],"summary":"Cancel invoice","description":"Cancel an invoice with a reason. Only draft or sent invoices can be cancelled. Requires SUPER_ADMIN role.","operationId":"cancelInvoice","parameters":[{"name":"id","in":"path","description":"Invoice unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"requestBody":{"description":"Cancellation request with reason","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelInvoiceRequest"}}},"required":true},"responses":{"200":{"description":"Invoice cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponse"}}}},"400":{"description":"Invalid request data - Validation errors in request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Requires SUPER_ADMIN role","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Invoice not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error - Failed to cancel invoice","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions":{"get":{"tags":["Subscriptions"],"summary":"Get all subscriptions","description":"Retrieve a paginated list of all subscriptions in the platform. Requires SUPER_ADMIN or ADMIN role.","operationId":"getAllSubscriptions","parameters":[{"name":"page","in":"query","description":"Page number (0-based)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Page size (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20},{"name":"sort","in":"query","description":"Sort field","required":false,"schema":{"type":"string","default":"createdAt"},"example":"createdAt"},{"name":"direction","in":"query","description":"Sort direction (ASC or DESC)","required":false,"schema":{"type":"string","default":"DESC","enum":["ASC","DESC"]},"example":"DESC"}],"responses":{"200":{"description":"Successfully retrieved subscription list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionListResponse"}}}},"400":{"description":"Invalid pagination parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/{id}":{"get":{"tags":["Subscriptions"],"summary":"Get subscription by ID","description":"Retrieve detailed information about a specific subscription by its unique identifier. Requires SUPER_ADMIN or ADMIN role.","operationId":"getSubscriptionById","parameters":[{"name":"id","in":"path","description":"Subscription unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Successfully retrieved subscription","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscriptions/tenant/{tenantId}":{"get":{"tags":["Subscriptions"],"summary":"Get subscription by tenant ID","description":"Retrieve the subscription for a specific tenant. Requires SUPER_ADMIN or ADMIN role.","operationId":"getSubscriptionByTenantId","parameters":[{"name":"tenantId","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Successfully retrieved subscription","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Subscription not found for the specified tenant","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/subscription-plans/active":{"get":{"tags":["Subscription Plans"],"summary":"Get all active subscription plans","description":"Retrieve a list of all active and visible subscription plans. No authentication required for public access.","operationId":"getActivePlans","responses":{"200":{"description":"Successfully retrieved active subscription plans","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices":{"get":{"tags":["Billing Invoices"],"summary":"Get all invoices","description":"Retrieve a paginated list of all billing invoices in the platform. Requires SUPER_ADMIN or ADMIN role.","operationId":"getAllInvoices","parameters":[{"name":"page","in":"query","description":"Page number (0-based)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Page size (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20},{"name":"sort","in":"query","description":"Sort field","required":false,"schema":{"type":"string","default":"createdAt"},"example":"createdAt"},{"name":"direction","in":"query","description":"Sort direction (ASC or DESC)","required":false,"schema":{"type":"string","default":"DESC","enum":["ASC","DESC"]},"example":"DESC"}],"responses":{"200":{"description":"Successfully retrieved invoice list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceListResponse"}}}},"400":{"description":"Invalid pagination parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/{id}":{"get":{"tags":["Billing Invoices"],"summary":"Get invoice by ID","description":"Retrieve detailed information about a specific invoice by its unique identifier. Requires SUPER_ADMIN or ADMIN role.","operationId":"getInvoiceById","parameters":[{"name":"id","in":"path","description":"Invoice unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"}],"responses":{"200":{"description":"Successfully retrieved invoice","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Invoice not found with the specified ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/tenant/{tenantId}":{"get":{"tags":["Billing Invoices"],"summary":"Get invoices by tenant ID","description":"Retrieve all invoices for a specific tenant. Requires SUPER_ADMIN or ADMIN role.","operationId":"getInvoicesByTenantId","parameters":[{"name":"tenantId","in":"path","description":"Tenant unique identifier (UUID)","required":true,"schema":{"type":"string","format":"uuid"},"example":"550e8400-e29b-41d4-a716-446655440000"},{"name":"page","in":"query","description":"Page number (0-based)","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Page size (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20},"example":20},{"name":"sort","in":"query","description":"Sort field","required":false,"schema":{"type":"string","default":"createdAt"},"example":"createdAt"},{"name":"direction","in":"query","description":"Sort direction (ASC or DESC)","required":false,"schema":{"type":"string","default":"DESC","enum":["ASC","DESC"]},"example":"DESC"}],"responses":{"200":{"description":"Successfully retrieved invoice list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceListResponse"}}}},"400":{"description":"Invalid pagination parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/invoices/number/{invoiceNumber}":{"get":{"tags":["Billing Invoices"],"summary":"Get invoice by invoice number","description":"Retrieve detailed information about a specific invoice by its invoice number. Requires SUPER_ADMIN or ADMIN role.","operationId":"getInvoiceByNumber","parameters":[{"name":"invoiceNumber","in":"path","description":"Invoice number","required":true,"schema":{"type":"string"},"example":"INV-2025-00123"}],"responses":{"200":{"description":"Successfully retrieved invoice","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponse"}}}},"401":{"description":"Authentication required - Missing or invalid JWT token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Access denied - Insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Invoice not found with the specified invoice number","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/auth/user-info":{"get":{"tags":["Authentication"],"summary":"Get current user info","description":"Get information about the currently authenticated user. Requires valid access token.","operationId":"getCurrentUser","responses":{"200":{"description":"User info retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserInfoResponse"}}}},"401":{"description":"Unauthorized - Invalid or expired token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"Bearer Authentication":[]}]}},"/api/v1/auth/health":{"get":{"tags":["Authentication"],"summary":"Health check","description":"Simple endpoint to check if authentication service is running","operationId":"health","responses":{"200":{"description":"Service is healthy","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}}}}},"/actuator":{"get":{"tags":["Actuator"],"summary":"Actuator root web endpoint","operationId":"links","responses":{"200":{"description":"OK","content":{"application/vnd.spring-boot.actuator.v3+json":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Link"}}}},"application/vnd.spring-boot.actuator.v2+json":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Link"}}}},"application/json":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Link"}}}}}}}}},"/actuator/info":{"get":{"tags":["Actuator"],"summary":"Actuator web endpoint 'info'","operationId":"info","responses":{"200":{"description":"OK","content":{"application/vnd.spring-boot.actuator.v3+json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v2+json":{"schema":{"type":"object"}},"application/json":{"schema":{"type":"object"}}}}}}},"/actuator/health":{"get":{"tags":["Actuator"],"summary":"Actuator web endpoint 'health'","operationId":"health_1","responses":{"200":{"description":"OK","content":{"application/vnd.spring-boot.actuator.v3+json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v2+json":{"schema":{"type":"object"}},"application/json":{"schema":{"type":"object"}}}}}}}},"components":{"schemas":{"UpdateTenantRequest":{"type":"object","description":"Request to update tenant information","properties":{"name":{"type":"string","description":"Tenant display name","example":"Updated Restaurant Name","maxLength":255,"minLength":0},"legalName":{"type":"string","description":"Legal company name","maxLength":255,"minLength":0},"email":{"type":"string","format":"email","description":"Contact email","example":"newemail@restaurant.com","maxLength":255,"minLength":0},"phone":{"type":"string","description":"Contact phone","example":"+39 0987654321","maxLength":50,"minLength":0},"address":{"type":"string","description":"Street address","maxLength":500,"minLength":0},"city":{"type":"string","description":"City","example":"Roma","maxLength":100,"minLength":0},"province":{"type":"string","description":"Province/State","example":"RM","maxLength":50,"minLength":0},"postalCode":{"type":"string","description":"Postal code","example":"00100","maxLength":20,"minLength":0}}},"TenantResponse":{"type":"object","description":"Tenant information response","properties":{"id":{"type":"string","format":"uuid","description":"Tenant unique identifier","example":"550e8400-e29b-41d4-a716-446655440000"},"code":{"type":"string","description":"Tenant code (URL-friendly)","example":"TESTREST"},"name":{"type":"string","description":"Tenant display name","example":"Test Restaurant"},"legalName":{"type":"string","description":"Legal company name","example":"Test Restaurant S.r.l."},"vatNumber":{"type":"string","description":"VAT number","example":"IT12345678901"},"fiscalCode":{"type":"string","description":"Fiscal code","example":"RSSMRA80A01H501U"},"email":{"type":"string","description":"Contact email","example":"info@testrest.com"},"phone":{"type":"string","description":"Contact phone","example":"+39 0123456789"},"address":{"type":"string","description":"Street address"},"city":{"type":"string","description":"City","example":"Milano"},"province":{"type":"string","description":"Province/State","example":"MI"},"postalCode":{"type":"string","description":"Postal code","example":20100},"country":{"type":"string","description":"Country code ISO-2","example":"IT"},"status":{"type":"string","description":"Tenant status","enum":["ACTIVE","SUSPENDED","PENDING","CANCELLED","DELETED"]},"timezone":{"type":"string","description":"Timezone","example":"Europe/Rome"},"locale":{"type":"string","description":"Locale","example":"it_IT"},"currency":{"type":"string","description":"Currency code","example":"EUR"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"},"activatedAt":{"type":"string","format":"date-time","description":"Activation timestamp"},"suspendedAt":{"type":"string","format":"date-time","description":"Suspension timestamp"},"cancelledAt":{"type":"string","format":"date-time","description":"Cancellation timestamp"}}},"ErrorResponse":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"},"errorCode":{"type":"string"},"validationErrors":{"type":"array","items":{"$ref":"#/components/schemas/ValidationError"}},"metadata":{"type":"object","additionalProperties":{}}}},"ValidationError":{"type":"object","properties":{"field":{"type":"string"},"message":{"type":"string"},"rejectedValue":{}}},"UpdateSubscriptionPlanRequest":{"type":"object","description":"Request to update an existing subscription plan","properties":{"name":{"type":"string","description":"Plan display name","example":"Starter Plan","maxLength":255,"minLength":0},"description":{"type":"string","description":"Plan description","example":"Perfect for small restaurants starting out","maxLength":1000,"minLength":0},"priceMonthly":{"type":"number","description":"Monthly subscription price","example":49.0,"minimum":0.00},"priceYearly":{"type":"number","description":"Yearly subscription price (optional)","example":490.0,"minimum":0.00},"trialDays":{"type":"integer","format":"int32","description":"Trial period in days","example":14,"maximum":365,"minimum":0},"maxUsers":{"type":"integer","format":"int32","description":"Maximum number of users allowed","example":5,"minimum":1},"maxBranches":{"type":"integer","format":"int32","description":"Maximum number of branches allowed","example":1,"minimum":1},"maxOrdersMonthly":{"type":"integer","format":"int32","description":"Maximum orders per month","example":1000,"minimum":0},"features":{"type":"object","additionalProperties":{},"description":"Plan features (JSON object)","example":{"pos":true,"kitchen":true,"inventory":false}},"limits":{"type":"object","additionalProperties":{},"description":"Plan limits (JSON object)","example":{"storage_gb":5,"api_calls":1000}},"isActive":{"type":"boolean","description":"Whether the plan is active","example":true},"isVisible":{"type":"boolean","description":"Whether the plan is visible to customers","example":true},"sortOrder":{"type":"integer","format":"int32","description":"Display sort order","example":1,"minimum":0}},"required":["isActive","isVisible","name","priceMonthly"]},"SubscriptionPlanResponse":{"type":"object","description":"Subscription plan details","properties":{"id":{"type":"string","format":"uuid","description":"Plan unique identifier","example":"550e8400-e29b-41d4-a716-446655440000"},"code":{"type":"string","description":"Plan code","example":"STARTER"},"name":{"type":"string","description":"Plan name","example":"Starter Plan"},"description":{"type":"string","description":"Plan description","example":"Perfect for small restaurants starting out"},"priceMonthly":{"type":"number","description":"Monthly price","example":49.0},"priceYearly":{"type":"number","description":"Yearly price","example":490.0},"trialDays":{"type":"integer","format":"int32","description":"Trial days","example":14},"maxUsers":{"type":"integer","format":"int32","description":"Maximum users","example":5},"maxBranches":{"type":"integer","format":"int32","description":"Maximum branches","example":1},"maxOrdersMonthly":{"type":"integer","format":"int32","description":"Maximum monthly orders","example":1000},"features":{"type":"object","additionalProperties":{},"description":"Plan features"},"limits":{"type":"object","additionalProperties":{},"description":"Plan limits"},"isActive":{"type":"boolean","description":"Is plan active","example":true},"isVisible":{"type":"boolean","description":"Is plan visible","example":true},"sortOrder":{"type":"integer","format":"int32","description":"Sort order","example":1},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2025-01-01T10:00:00"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2025-01-15T14:30:00"}}},"CreateTenantRequest":{"type":"object","description":"Request to create a new tenant","properties":{"code":{"type":"string","description":"Unique tenant code","example":"TESTREST","maxLength":50,"minLength":3,"pattern":"^[A-Z0-9_]+$"},"name":{"type":"string","description":"Tenant display name","example":"Test Restaurant","maxLength":255,"minLength":0},"legalName":{"type":"string","description":"Legal company name","example":"Test Restaurant S.r.l.","maxLength":255,"minLength":0},"vatNumber":{"type":"string","description":"VAT number","example":"IT12345678901","maxLength":50,"minLength":0},"fiscalCode":{"type":"string","description":"Fiscal code","example":"RSSMRA80A01H501U","maxLength":50,"minLength":0},"email":{"type":"string","format":"email","description":"Contact email","example":"info@testrest.com","maxLength":255,"minLength":0},"phone":{"type":"string","description":"Contact phone","example":"+39 0123456789","maxLength":50,"minLength":0},"address":{"type":"string","description":"Street address","example":"Via Roma 123","maxLength":500,"minLength":0},"city":{"type":"string","description":"City","example":"Milano","maxLength":100,"minLength":0},"province":{"type":"string","description":"Province/State","example":"MI","maxLength":50,"minLength":0},"postalCode":{"type":"string","description":"Postal code","example":20100,"maxLength":20,"minLength":0},"country":{"type":"string","description":"Country code ISO-2","example":"IT","maxLength":2,"minLength":2},"timezone":{"type":"string","description":"Timezone","example":"Europe/Rome","maxLength":50,"minLength":0},"locale":{"type":"string","description":"Locale","example":"it_IT","maxLength":10,"minLength":0},"currency":{"type":"string","description":"Currency code","example":"EUR","maxLength":3,"minLength":3},"planCode":{"type":"string","description":"Subscription plan code","example":"BASIC","minLength":1},"billingCycle":{"type":"string","description":"Billing cycle","example":"MONTHLY"}},"required":["billingCycle","code","email","name","planCode"]},"CreateSubscriptionPlanRequest":{"type":"object","description":"Request to create a new subscription plan","properties":{"code":{"type":"string","description":"Unique plan code","example":"STARTER","maxLength":50,"minLength":3,"pattern":"^[A-Z0-9_]+$"},"name":{"type":"string","description":"Plan display name","example":"Starter Plan","maxLength":255,"minLength":0},"description":{"type":"string","description":"Plan description","example":"Perfect for small restaurants starting out","maxLength":1000,"minLength":0},"priceMonthly":{"type":"number","description":"Monthly subscription price","example":49.0,"minimum":0.00},"priceYearly":{"type":"number","description":"Yearly subscription price (optional)","example":490.0,"minimum":0.00},"trialDays":{"type":"integer","format":"int32","description":"Trial period in days","example":14,"maximum":365,"minimum":0},"maxUsers":{"type":"integer","format":"int32","description":"Maximum number of users allowed","example":5,"minimum":1},"maxBranches":{"type":"integer","format":"int32","description":"Maximum number of branches allowed","example":1,"minimum":1},"maxOrdersMonthly":{"type":"integer","format":"int32","description":"Maximum orders per month","example":1000,"minimum":0},"features":{"type":"object","additionalProperties":{},"description":"Plan features (JSON object)","example":{"pos":true,"kitchen":true,"inventory":false}},"limits":{"type":"object","additionalProperties":{},"description":"Plan limits (JSON object)","example":{"storage_gb":5,"api_calls":1000}},"isActive":{"type":"boolean","description":"Whether the plan is active","example":true},"isVisible":{"type":"boolean","description":"Whether the plan is visible to customers","example":true},"sortOrder":{"type":"integer","format":"int32","description":"Display sort order","example":1,"minimum":0}},"required":["code","isActive","isVisible","name","priceMonthly"]},"RefreshTokenRequest":{"type":"object","description":"Refresh token request","properties":{"refreshToken":{"type":"string","description":"Refresh token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","minLength":1}},"required":["refreshToken"]},"RefreshTokenResponse":{"type":"object","description":"Refresh token response with new tokens","properties":{"accessToken":{"type":"string","description":"New JWT access token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refreshToken":{"type":"string","description":"New JWT refresh token (rotation)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"tokenType":{"type":"string","description":"Token type","example":"Bearer"},"expiresIn":{"type":"integer","format":"int64","description":"Access token expiration time in seconds","example":900}}},"LoginRequest":{"type":"object","description":"Login request with username and password","properties":{"username":{"type":"string","description":"Username","example":"admin","minLength":1},"password":{"type":"string","description":"Password","example":"Pass123!","minLength":1}},"required":["password","username"]},"LoginResponse":{"type":"object","description":"Login response with tokens and user info","properties":{"accessToken":{"type":"string","description":"JWT access token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refreshToken":{"type":"string","description":"JWT refresh token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"tokenType":{"type":"string","description":"Token type","example":"Bearer"},"expiresIn":{"type":"integer","format":"int64","description":"Access token expiration time in seconds","example":900},"user":{"$ref":"#/components/schemas/UserInfo","description":"User information"}}},"UserInfo":{"type":"object","description":"User information included in login response","properties":{"id":{"type":"string","format":"uuid","description":"User ID","example":"550e8400-e29b-41d4-a716-446655440000"},"username":{"type":"string","description":"Username","example":"admin"},"email":{"type":"string","description":"Email","example":"admin@rmp.com"},"firstName":{"type":"string","description":"First name","example":"Mario"},"lastName":{"type":"string","description":"Last name","example":"Rossi"},"role":{"type":"string","description":"User role","enum":["VIEWER","SUPPORT","ADMIN","SUPER_ADMIN"],"example":"SUPER_ADMIN"},"lastLoginAt":{"type":"string","format":"date-time","description":"Last login timestamp"}}},"UpgradeSubscriptionRequest":{"type":"object","description":"Request to upgrade subscription to a new plan","properties":{"planCode":{"type":"string","description":"New plan code","example":"PROFESSIONAL","minLength":1}},"required":["planCode"]},"SubscriptionResponse":{"type":"object","description":"Subscription details","properties":{"id":{"type":"string","format":"uuid","description":"Subscription unique identifier","example":"550e8400-e29b-41d4-a716-446655440000"},"tenantId":{"type":"string","format":"uuid","description":"Tenant ID"},"tenantCode":{"type":"string","description":"Tenant code","example":"TESTREST"},"tenantName":{"type":"string","description":"Tenant name","example":"Test Restaurant"},"planId":{"type":"string","format":"uuid","description":"Plan ID"},"planCode":{"type":"string","description":"Plan code","example":"STARTER"},"planName":{"type":"string","description":"Plan name","example":"Starter Plan"},"status":{"type":"string","description":"Subscription status","enum":["TRIAL","ACTIVE","PAST_DUE","CANCELLED","EXPIRED"],"example":"ACTIVE"},"billingCycle":{"type":"string","description":"Billing cycle","enum":["MONTHLY","YEARLY","CUSTOM"],"example":"MONTHLY"},"currentPeriodStart":{"type":"string","format":"date","description":"Current period start date","example":"2025-01-01"},"currentPeriodEnd":{"type":"string","format":"date","description":"Current period end date","example":"2025-01-31"},"trialStart":{"type":"string","format":"date","description":"Trial start date","example":"2025-01-01"},"trialEnd":{"type":"string","format":"date","description":"Trial end date","example":"2025-01-14"},"cancelAtPeriodEnd":{"type":"boolean","description":"Cancel at period end","example":false},"cancelledAt":{"type":"string","format":"date-time","description":"Cancelled at timestamp"},"cancelledReason":{"type":"string","description":"Cancellation reason"},"paymentMethod":{"type":"string","description":"Payment method","example":"credit_card"},"lastPaymentDate":{"type":"string","format":"date","description":"Last payment date","example":"2025-01-01"},"lastPaymentAmount":{"type":"number","description":"Last payment amount","example":49.0},"nextPaymentDate":{"type":"string","format":"date","description":"Next payment date","example":"2025-02-01"},"nextPaymentAmount":{"type":"number","description":"Next payment amount","example":49.0},"metadata":{"type":"object","additionalProperties":{},"description":"Subscription metadata"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2025-01-01T10:00:00"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2025-01-15T14:30:00"}}},"ChangeBillingCycleRequest":{"type":"object","description":"Request to change billing cycle","properties":{"billingCycle":{"type":"string","description":"New billing cycle","enum":["MONTHLY","YEARLY","CUSTOM"],"example":"YEARLY"}},"required":["billingCycle"]},"CancelSubscriptionRequest":{"type":"object","description":"Request to cancel subscription","properties":{"reason":{"type":"string","description":"Cancellation reason","example":"Customer request","maxLength":500,"minLength":0},"immediate":{"type":"boolean","description":"Cancel immediately or at period end","example":false}},"required":["reason"]},"InvoiceResponse":{"type":"object","description":"Invoice details","properties":{"id":{"type":"string","format":"uuid","description":"Invoice unique identifier","example":"550e8400-e29b-41d4-a716-446655440000"},"tenantId":{"type":"string","format":"uuid","description":"Tenant ID"},"tenantCode":{"type":"string","description":"Tenant code","example":"TESTREST"},"tenantName":{"type":"string","description":"Tenant name","example":"Test Restaurant"},"subscriptionId":{"type":"string","format":"uuid","description":"Subscription ID"},"invoiceNumber":{"type":"string","description":"Invoice number","example":"INV-2025-00123"},"status":{"type":"string","description":"Invoice status","enum":["DRAFT","SENT","PAID","OVERDUE","CANCELLED"],"example":"SENT"},"billingPeriodStart":{"type":"string","format":"date","description":"Billing period start date","example":"2025-01-01"},"billingPeriodEnd":{"type":"string","format":"date","description":"Billing period end date","example":"2025-01-31"},"dueDate":{"type":"string","format":"date","description":"Invoice due date","example":"2025-02-15"},"subtotal":{"type":"number","description":"Subtotal amount","example":49.0},"taxRate":{"type":"number","description":"Tax rate percentage","example":22.0},"taxAmount":{"type":"number","description":"Tax amount","example":10.78},"discountAmount":{"type":"number","description":"Discount amount","example":0.0},"total":{"type":"number","description":"Total amount","example":59.78},"currency":{"type":"string","description":"Currency code","example":"EUR"},"paymentStatus":{"type":"string","description":"Payment status","enum":["PENDING","PAID","PARTIAL","FAILED","REFUNDED"],"example":"PENDING"},"paymentDate":{"type":"string","format":"date","description":"Payment date","example":"2025-02-10"},"paymentMethod":{"type":"string","description":"Payment method","example":"credit_card"},"paymentReference":{"type":"string","description":"Payment reference","example":"TXN-123456"},"notes":{"type":"string","description":"Notes"},"lineItems":{"type":"array","description":"Line items","items":{"type":"object","additionalProperties":{}}},"metadata":{"type":"object","additionalProperties":{},"description":"Invoice metadata"},"isOverdue":{"type":"boolean","description":"Is invoice overdue","example":false},"daysOverdue":{"type":"integer","format":"int64","description":"Days overdue","example":0},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2025-01-01T10:00:00"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2025-01-15T14:30:00"}}},"MarkInvoiceAsPaidRequest":{"type":"object","description":"Request to mark invoice as paid","properties":{"paymentMethod":{"type":"string","description":"Payment method","example":"credit_card","maxLength":50,"minLength":0},"paymentReference":{"type":"string","description":"Payment reference or transaction ID","example":"TXN-123456","maxLength":255,"minLength":0}},"required":["paymentMethod","paymentReference"]},"CancelInvoiceRequest":{"type":"object","description":"Request to cancel invoice","properties":{"reason":{"type":"string","description":"Cancellation reason","example":"Duplicate invoice","maxLength":500,"minLength":0}},"required":["reason"]},"TenantListResponse":{"type":"object","description":"Paginated list of tenants","properties":{"tenants":{"type":"array","description":"List of tenants","items":{"$ref":"#/components/schemas/TenantResponse"}},"total":{"type":"integer","format":"int64","description":"Total number of tenants","example":42},"page":{"type":"integer","format":"int32","description":"Current page number","example":0},"size":{"type":"integer","format":"int32","description":"Page size","example":20},"totalPages":{"type":"integer","format":"int32","description":"Total number of pages","example":3}}},"SubscriptionListResponse":{"type":"object","description":"Paginated list of subscriptions","properties":{"subscriptions":{"type":"array","description":"List of subscriptions","items":{"$ref":"#/components/schemas/SubscriptionResponse"}},"total":{"type":"integer","format":"int64","description":"Total number of subscriptions","example":150},"page":{"type":"integer","format":"int32","description":"Current page number (0-based)","example":0},"size":{"type":"integer","format":"int32","description":"Page size","example":20},"totalPages":{"type":"integer","format":"int32","description":"Total number of pages","example":8}}},"SubscriptionPlanListResponse":{"type":"object","description":"Paginated list of subscription plans","properties":{"plans":{"type":"array","description":"List of subscription plans","items":{"$ref":"#/components/schemas/SubscriptionPlanResponse"}},"total":{"type":"integer","format":"int64","description":"Total number of plans","example":10},"page":{"type":"integer","format":"int32","description":"Current page number (0-based)","example":0},"size":{"type":"integer","format":"int32","description":"Page size","example":20},"totalPages":{"type":"integer","format":"int32","description":"Total number of pages","example":1}}},"InvoiceListResponse":{"type":"object","description":"Paginated list of invoices","properties":{"invoices":{"type":"array","description":"List of invoices","items":{"$ref":"#/components/schemas/InvoiceResponse"}},"total":{"type":"integer","format":"int64","description":"Total number of invoices","example":250},"page":{"type":"integer","format":"int32","description":"Current page number (0-based)","example":0},"size":{"type":"integer","format":"int32","description":"Page size","example":20},"totalPages":{"type":"integer","format":"int32","description":"Total number of pages","example":13}}},"UserInfoResponse":{"type":"object","description":"Current authenticated user information","properties":{"id":{"type":"string","format":"uuid","description":"User ID","example":"550e8400-e29b-41d4-a716-446655440000"},"username":{"type":"string","description":"Username","example":"admin"},"email":{"type":"string","description":"Email","example":"admin@rmp.com"},"firstName":{"type":"string","description":"First name","example":"Mario"},"lastName":{"type":"string","description":"Last name","example":"Rossi"},"role":{"type":"string","description":"User role","enum":["VIEWER","SUPPORT","ADMIN","SUPER_ADMIN"],"example":"SUPER_ADMIN"},"isActive":{"type":"boolean","description":"Account active status","example":true},"lastLoginAt":{"type":"string","format":"date-time","description":"Last login timestamp"},"createdAt":{"type":"string","format":"date-time","description":"Account created timestamp"}}},"Link":{"type":"object","properties":{"href":{"type":"string"},"templated":{"type":"boolean"}}}},"securitySchemes":{"bearerAuth":{"type":"http","description":"JWT token ottenuto tramite login","scheme":"bearer","bearerFormat":"JWT"}}}}